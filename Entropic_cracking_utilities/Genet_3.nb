(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15053,        348]
NotebookOptionsPosition[     13684,        318]
NotebookOutlinePosition[     14053,        334]
CellTagsIndexPosition[     14010,        331]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fava", "=", "200"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pts", "=", 
     RowBox[{"RandomPoint", "[", 
      RowBox[{
       RowBox[{"Sphere", "[", "k", "]"}], ",", " ", "fava"}], "]"}]}], " ", 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7811868967906566`*^9, 3.781186958416811*^9}, {
   3.781187311889309*^9, 3.781187313482627*^9}, {3.7811899456641264`*^9, 
   3.781189959176463*^9}, {3.7811944210322795`*^9, 3.781194434310809*^9}, {
   3.7811969996532307`*^9, 3.7811970000906706`*^9}, {3.781197660871662*^9, 
   3.7811976814918423`*^9}, 3.7811978930517817`*^9, 3.7811992584424543`*^9, 
   3.781199366622634*^9, {3.781202353078063*^9, 3.781202353718605*^9}, {
   3.781202555670862*^9, 3.781202556389727*^9}, {3.781202730762534*^9, 
   3.78120273573038*^9}, {3.7812028561203604`*^9, 3.781202859244666*^9}, {
   3.781202987746992*^9, 3.781203003243681*^9}, {3.7812791841430235`*^9, 
   3.7812791842657747`*^9}, {3.7812951351255784`*^9, 
   3.7812951367814274`*^9}, {3.781295247052704*^9, 3.7812952479897003`*^9}, {
   3.7812953625916815`*^9, 3.781295369777813*^9}, {3.781295458257044*^9, 
   3.7812954584129353`*^9}, {3.78129553733792*^9, 3.781295540040372*^9}, {
   3.781295618740622*^9, 3.7812956240987363`*^9}, {3.7812960234577894`*^9, 
   3.781296063276884*^9}, {3.781365067483792*^9, 3.7813650691326914`*^9}, {
   3.781365496538888*^9, 3.781365497351204*^9}, 3.782147254694973*^9, {
   3.782154083152131*^9, 3.782154084245302*^9}, {3.782154809188261*^9, 
   3.782154810360176*^9}, {3.782155353706149*^9, 3.782155355924261*^9}, 
   3.7821555100200543`*^9},ExpressionUUID->"28bc720b-6a6a-47e3-8a4a-\
404380137439"],

Cell[BoxData["200"], "Output",
 CellChangeTimes->{
  3.7811869591353884`*^9, 3.7811870373542986`*^9, 3.7811873158255024`*^9, {
   3.781189961113178*^9, 3.781189972063727*^9}, {3.7811944361849937`*^9, 
   3.781194439496681*^9}, 3.7811970043080597`*^9, 3.78119711623477*^9, 
   3.781197160364997*^9, 3.781197200683652*^9, 3.7811974702527843`*^9, {
   3.781197664948815*^9, 3.781197684053704*^9}, 3.781198606727324*^9, 
   3.7811990085048075`*^9, {3.781199234850561*^9, 3.7811992610980663`*^9}, 
   3.7811993949749966`*^9, 3.7812001779013853`*^9, 3.781200351013324*^9, 
   3.7812025591075783`*^9, 3.781202610501724*^9, 3.7812026497893705`*^9, 
   3.781202741713081*^9, {3.781202990746276*^9, 3.7812030063832245`*^9}, 
   3.781229044557495*^9, {3.781279177964028*^9, 3.7812791869533052`*^9}, {
   3.7812942963788557`*^9, 3.7812943236693244`*^9}, 3.7812944600435414`*^9, {
   3.781295110803121*^9, 3.781295139265224*^9}, 3.7812952514732103`*^9, {
   3.781295370511729*^9, 3.781295373042387*^9}, 3.781295461474739*^9, 
   3.7812955424145117`*^9, 3.7812956285036674`*^9, {3.7812960323775606`*^9, 
   3.7812960681504397`*^9}, 3.7813654998506107`*^9, 3.7813657215365906`*^9, 
   3.7821471461419315`*^9, 3.782147269079206*^9, 3.7821533762461324`*^9, 
   3.782154087369562*^9, 3.7821541213805785`*^9, {3.7821542933226757`*^9, 
   3.782154305694751*^9}, {3.782154385878946*^9, 3.782154422479664*^9}, 
   3.782154813124792*^9, {3.782155494929904*^9, 3.782155517752597*^9}, 
   3.7821556531268663`*^9, 3.7821557309053144`*^9, 
   3.782155776706979*^9},ExpressionUUID->"0eb75bee-ea7a-4e3a-81b1-\
9a817d93cb8e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"c", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "6", ",", "2", ",", "1", ",", "0.2"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.7811874975288916`*^9, 3.7811875049960012`*^9}, {
   3.7811894128150244`*^9, 3.7811894129090667`*^9}, {3.7811906244851675`*^9, 
   3.7811906245632677`*^9}, {3.7811912364535913`*^9, 
   3.7811912432017555`*^9}, {3.78119710334744*^9, 3.781197104143944*^9}, {
   3.7811974487422132`*^9, 3.7811974580527797`*^9}, {3.7811985755627346`*^9, 
   3.781198591840458*^9}, {3.781198997132744*^9, 3.781199005349597*^9}, 
   3.7812028375781565`*^9, {3.7813656890444975`*^9, 3.781365718474845*^9}, 
   3.7821543999540434`*^9},ExpressionUUID->"f0b340f0-0ded-4711-810e-\
a14d2f02005f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "6", ",", "2", ",", "1", ",", "0.2`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.781365705181093*^9, 3.7813657215990915`*^9}, 
   3.7821471463823595`*^9, 3.7821472693424034`*^9, 3.7821533763398514`*^9, 
   3.7821540874789095`*^9, 3.782154121505546*^9, {3.782154293432048*^9, 
   3.782154305819723*^9}, {3.7821543859882803`*^9, 3.782154422588979*^9}, 
   3.7821548132341747`*^9, {3.7821554950079813`*^9, 3.7821555178150826`*^9}, 
   3.7821556531581087`*^9, 3.782155730952177*^9, 
   3.7821557767694635`*^9},ExpressionUUID->"971c5dea-12ab-48fd-b09b-\
9f324993d935"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"omega", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", "k"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.781187508557542*^9, 3.7811875272562723`*^9}, {
   3.781197108689967*^9, 3.781197113267068*^9}, {3.7811974617079244`*^9, 
   3.7811974664883814`*^9}, {3.7811985795617943`*^9, 
   3.7811986029160213`*^9}, {3.78119922846014*^9, 3.781199232021839*^9}, 
   3.7812028354692335`*^9},ExpressionUUID->"17f4c496-2415-49f4-b5a7-\
b7186bb1e2db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"harmampl", "[", 
   RowBox[{"a_", ",", " ", "omega_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"1", "*", 
       RowBox[{"a", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"a", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "*", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"omega", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", 
         RowBox[{"omega", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "k"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{"1", "/", "2"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.78118884577718*^9, 3.781188851338536*^9}, 
   3.78118950738225*^9, {3.7811895916177425`*^9, 3.781189614249483*^9}, {
   3.781198036052701*^9, 3.7811980385052705`*^9}, {3.7811982901882806`*^9, 
   3.781198298373845*^9}, {3.7811989775591836`*^9, 3.7811989803551507`*^9}, {
   3.7821557656471047`*^9, 
   3.7821557708021326`*^9}},ExpressionUUID->"265f1092-eadb-402e-8378-\
ea2e05be1fb8"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gun", "[", 
      RowBox[{"u_", ",", "p_"}], "]"}], ":=", 
     RowBox[{"u", " ", "p"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c1", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"c", ",", "fava"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7811940616968365`*^9, 3.7811940626968966`*^9}, {
   3.7811942457217455`*^9, 3.781194283182279*^9}, {3.781194376839769*^9, 
   3.7811943887277145`*^9}, {3.7811944424651065`*^9, 
   3.7811944433398824`*^9}, {3.781194496880062*^9, 3.7811945084400735`*^9}, {
   3.7811979087353563`*^9, 3.781197916655361*^9}, 3.78129431737396*^9, 
   3.78215438281748*^9},ExpressionUUID->"84073d0d-9cd0-4670-b6a5-\
75eb29eba12a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"amplo", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"gun", ",", 
     RowBox[{"{", 
      RowBox[{"pts", ",", "c1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.781194263108091*^9, 3.7811942975831623`*^9}, {
   3.781194333642051*^9, 3.781194353902986*^9}, 3.7811943974600935`*^9, {
   3.7811946222962313`*^9, 3.781194623733415*^9}, 3.7811979191706533`*^9, 
   3.7811980635462523`*^9, 
   3.7812028304076514`*^9},ExpressionUUID->"a6d9eb6c-bcd8-4451-ac79-\
19784f92548e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"damage", " ", "=", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"harmampl", "[", 
         RowBox[{"#", ",", "omega"}], "]"}], "&"}], "/@", "amplo"}], ")"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7811942552348995`*^9, 3.7811942556255727`*^9}, {
   3.781194475191679*^9, 3.7811944892412214`*^9}, {3.781194590788024*^9, 
   3.7811946644174786`*^9}, {3.7811948065242863`*^9, 3.7811948083518443`*^9}, 
   3.7811979221384096`*^9, 3.781198056172988*^9, {3.7811985022322264`*^9, 
   3.781198509324613*^9}, 3.7812028455603905`*^9, {3.7821556446757045`*^9, 
   3.7821556503309317`*^9}, {3.782155727156478*^9, 
   3.7821557278282385`*^9}},ExpressionUUID->"a7bcaa68-36f9-4f0f-ad26-\
2e2d38ed1f9f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"varsam", " ", "=", " ", 
   RowBox[{"Array", "[", 
    RowBox[{"l", ",", "k"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varome", " ", "=", " ", 
    RowBox[{"Array", "[", 
     RowBox[{"m", ",", 
      RowBox[{"k", "-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol11", "=", 
   RowBox[{"NMinimize", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"damage", "[", 
           RowBox[{"[", "s", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"harmampl", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", "0", "}"}], ",", "varome"}], "]"}]}], "]"}], 
              "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"MapThread", "[", 
               RowBox[{"gun", ",", 
                RowBox[{"{", 
                 RowBox[{"pts", ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"varsam", ",", "fava"}], "]"}]}], "}"}]}], "]"}], 
              ")"}]}], ")"}], "[", 
           RowBox[{"[", "s", "]"}], "]"}]}], ")"}], "^", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "1", ",", "fava"}], "}"}]}], "]"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{"varsam", ",", "varome"}], "]"}], ",", " ", 
     RowBox[{"Method", "\[Rule]", "\"\<SimulatedAnnealing\>\""}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7811950508613343`*^9, 3.781195062655702*^9}, {
   3.7811950993343277`*^9, 3.7811951012088575`*^9}, {3.7811951669280925`*^9, 
   3.781195181877712*^9}, {3.7811953130812316`*^9, 3.781195326015473*^9}, {
   3.7811956802830667`*^9, 3.781195688218464*^9}, {3.7811957784007874`*^9, 
   3.781195778462948*^9}, {3.781196069695701*^9, 3.7811960915186357`*^9}, 
   3.7811971356523733`*^9, {3.781295029462884*^9, 3.78129510417971*^9}, {
   3.781295295572571*^9, 3.7812953376912804`*^9}, 3.7821533720596247`*^9, 
   3.7821542829501667`*^9},ExpressionUUID->"68e08c14-1db0-4464-bbce-\
01f358b11656"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.6046330879094576`*^-12", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"l", "[", "1", "]"}], "\[Rule]", "0.9999999557426632`"}], ",", 
     RowBox[{
      RowBox[{"l", "[", "2", "]"}], "\[Rule]", "1.9999999393159842`"}], ",", 
     RowBox[{
      RowBox[{"l", "[", "3", "]"}], "\[Rule]", "5.999999896627881`"}], ",", 
     RowBox[{
      RowBox[{"l", "[", "4", "]"}], "\[Rule]", "1.9999999763079228`"}], ",", 
     RowBox[{
      RowBox[{"l", "[", "5", "]"}], "\[Rule]", 
      RowBox[{"-", "1.0000000852275828`"}]}], ",", 
     RowBox[{
      RowBox[{"l", "[", "6", "]"}], "\[Rule]", "0.20000253761935494`"}], ",", 
     RowBox[{
      RowBox[{"m", "[", "1", "]"}], "\[Rule]", "0.00003018347324978754`"}], 
     ",", 
     RowBox[{
      RowBox[{"m", "[", "2", "]"}], "\[Rule]", "0.000011038071042714956`"}], 
     ",", 
     RowBox[{
      RowBox[{"m", "[", "3", "]"}], "\[Rule]", "0.00006185339211004825`"}], 
     ",", 
     RowBox[{
      RowBox[{"m", "[", "4", "]"}], "\[Rule]", "3.1419480708111722`"}], ",", 
     RowBox[{
      RowBox[{"m", "[", "5", "]"}], "\[Rule]", "0.005105256721071652`"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7812951113967676`*^9, 3.7812951409366703`*^9}, 
   3.7812952520824776`*^9, {3.781295311334183*^9, 3.781295340799923*^9}, 
   3.781295373979664*^9, 3.7812954633024373`*^9, 3.7812956002290564`*^9, 
   3.7812960163344517`*^9, 3.781365494945548*^9, 3.78136564485328*^9, 
   3.7813658592603397`*^9, 3.782147185679552*^9, 3.7821474182280197`*^9, 
   3.7821534989046173`*^9, 3.7821540885411606`*^9, 3.7821541223959613`*^9, {
   3.7821542941037426`*^9, 3.7821543065070643`*^9}, {3.782154386581909*^9, 
   3.7821544231201406`*^9}, 3.782155333451584*^9, 3.7821555141440783`*^9, 
   3.782155544699354*^9, 3.782155679276901*^9, 3.7821557576802635`*^9, 
   3.782155808246434*^9},ExpressionUUID->"ee7ccaf4-31e3-4a08-8616-\
1be2d799bca4"]
}, Open  ]]
},
WindowSize->{1600, 817},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification->1.25,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1726, 29, 108, "Input",ExpressionUUID->"28bc720b-6a6a-47e3-8a4a-404380137439"],
Cell[2309, 53, 1595, 23, 40, "Output",ExpressionUUID->"0eb75bee-ea7a-4e3a-81b1-9a817d93cb8e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3941, 81, 781, 14, 60, "Input",ExpressionUUID->"f0b340f0-0ded-4711-810e-a14d2f02005f"],
Cell[4725, 97, 624, 11, 40, "Output",ExpressionUUID->"971c5dea-12ab-48fd-b09b-9f324993d935"]
}, Open  ]],
Cell[5364, 111, 495, 10, 35, "Input",ExpressionUUID->"17f4c496-2415-49f4-b5a7-b7186bb1e2db"],
Cell[5862, 123, 1201, 31, 35, "Input",ExpressionUUID->"265f1092-eadb-402e-8378-ea2e05be1fb8"],
Cell[7066, 156, 882, 20, 180, "Input",ExpressionUUID->"84073d0d-9cd0-4670-b6a5-75eb29eba12a"],
Cell[7951, 178, 522, 12, 35, "Input",ExpressionUUID->"a6d9eb6c-bcd8-4451-ac79-19784f92548e"],
Cell[8476, 192, 854, 18, 108, "Input",ExpressionUUID->"a7bcaa68-36f9-4f0f-ad26-2e2d38ed1f9f"],
Cell[CellGroupData[{
Cell[9355, 214, 2367, 57, 276, "Input",ExpressionUUID->"68e08c14-1db0-4464-bbce-01f358b11656"],
Cell[11725, 273, 1943, 42, 72, "Output",ExpressionUUID->"ee7ccaf4-31e3-4a08-8616-1be2d799bca4"]
}, Open  ]]
}
]
*)

